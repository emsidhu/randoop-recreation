<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>TreeMap.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">randoop-recreation</a> &gt; <a href="index.source.html" class="el_package">com.demo</a> &gt; <span class="el_source">TreeMap.java</span></div><h1>TreeMap.java</h1><pre class="source lang-java linenums">package com.demo;

import java.util.HashSet;
import java.util.Set;

//Taken from JPF examples directory.

public class TreeMap {

<span class="fc" id="L10">  private static long startTime = System.currentTimeMillis();</span>

  // @NotPartOfState
  // private Comparator comparator = null;

<span class="fc" id="L15">  private transient Entry root = null;</span>

<span class="fc" id="L17">  private transient int size = 0;</span>

  private void incrementSize() {
    /*modCount++;*/
<span class="fc" id="L21">    size++;</span>
<span class="fc" id="L22">  }</span>

  private void decrementSize() {
    /*modCount++;*/
<span class="fc" id="L26">    size--;</span>
<span class="fc" id="L27">  }</span>

  //--------------------------------------------------------------------
<span class="fc" id="L30">  private static void outputTestSequence(int number) {}</span>

  private native boolean checkAbstractState(int which);

<span class="fc" id="L34">  public static Set&lt;String&gt; branchFingerprints = new HashSet&lt;&gt;();</span>

<span class="fc" id="L36">  public static int counter = 0;</span>

  private static int gen_native(int br, Entry e, Entry root) {

<span class="fc" id="L40">    String res = br + &quot;,&quot;;</span>
    //For Basic Block Coverage
    //START comment here

<span class="pc bpc" id="L44" title="1 of 2 branches missed.">    if (e == null) {</span>
<span class="nc" id="L45">      res += &quot;entry=null&quot;;</span>
<span class="nc" id="L46">    } else {</span>
<span class="fc" id="L47">      Entry e_left = e.left;</span>
<span class="pc bpc" id="L48" title="1 of 2 branches missed.">      res += (e_left == null) ? &quot;L-&quot; : &quot;L+&quot;;</span>
<span class="fc" id="L49">      Entry e_right = e.right;</span>
<span class="pc bpc" id="L50" title="1 of 2 branches missed.">      res += (e_right == null) ? &quot;R-&quot; : &quot;R+&quot;;</span>
<span class="fc" id="L51">      Entry e_parent = e.parent;</span>
<span class="pc bpc" id="L52" title="1 of 2 branches missed.">      res += (e_parent == null) ? &quot;P-&quot; : &quot;P+&quot;;</span>
<span class="fc" id="L53">      boolean e_color = e.color;</span>
<span class="pc bpc" id="L54" title="1 of 2 branches missed.">      res += (e_color == false) ? &quot;RED&quot; : &quot;BLACK&quot;;</span>
<span class="pc bpc" id="L55" title="1 of 2 branches missed.">      res += (e == root) ? &quot;root&quot; : &quot;&quot;;</span>
    }
    //For Basic Block Coverage
    //END comment here

<span class="fc bfc" id="L60" title="All 2 branches covered.">    if (!branchFingerprints.contains(res)) {</span>
<span class="fc" id="L61">      branchFingerprints.add(res);</span>
      // System.out.println(&quot;TIME=&quot; + (System.currentTimeMillis() - startTime));
<span class="fc" id="L63">      System.out.println(&quot;Test case number &quot; + branchFingerprints.size() + &quot; for '&quot; + res + &quot;': &quot;);</span>
      //System.out.println(&quot;tree = &quot; + tree);
<span class="fc" id="L65">      counter = branchFingerprints.size();</span>
<span class="fc" id="L66">      return branchFingerprints.size();</span>
    }
<span class="fc" id="L68">    return 0;</span>
  }

  void gen(int branch, Entry e) { //SPECIFY
<span class="fc" id="L72">    int c = gen_native(branch, e, root); //SPECIFY</span>
<span class="fc bfc" id="L73" title="All 2 branches covered.">    if (c != 0) outputTestSequence(c);</span>
<span class="fc" id="L74">  }</span>

  //-------------------------------------------------------------------

<span class="fc" id="L78">  public TreeMap() {}</span>

  public int size() {
<span class="fc" id="L81">    return size;</span>
  }

  public boolean containsKey(int key) {
<span class="fc bfc" id="L85" title="All 2 branches covered.">    return getEntry(key) != null;</span>
  }

  private Entry getEntry(int key) {
<span class="fc" id="L89">    Entry p = root;</span>
<span class="fc bfc" id="L90" title="All 2 branches covered.">    while (p != null) {</span>
<span class="fc bfc" id="L91" title="All 2 branches covered.">      if (key == p.key) return p;</span>
<span class="fc bfc" id="L92" title="All 2 branches covered.">      else if (key &lt; p.key) p = p.left;</span>
<span class="fc" id="L93">      else p = p.right;</span>
    }
<span class="fc" id="L95">    return null;</span>
  }

  public void put(int key) {
<span class="fc" id="L99">    Entry t = root;</span>

<span class="fc bfc" id="L101" title="All 2 branches covered.">    if (t == null) {</span>
<span class="fc" id="L102">      incrementSize();</span>
<span class="fc" id="L103">      root = new Entry(key, null);</span>
<span class="fc" id="L104">      return;</span>
    }

    while (true) {
<span class="fc bfc" id="L108" title="All 2 branches covered.">      if (key == t.key) {</span>
<span class="fc" id="L109">        return;</span>
<span class="fc bfc" id="L110" title="All 2 branches covered.">      } else if (key &lt; t.key) {</span>
<span class="pc bpc" id="L111" title="1 of 2 branches missed.">        if (t.left != null) {</span>
<span class="nc" id="L112">          t = t.left;</span>
<span class="nc" id="L113">        } else {</span>
<span class="fc" id="L114">          incrementSize();</span>
<span class="fc" id="L115">          t.left = new Entry(key, t);</span>
<span class="fc" id="L116">          fixAfterInsertion(t.left);</span>
<span class="fc" id="L117">          return;</span>
        }
      } else { // key &gt; t.key
<span class="pc bpc" id="L120" title="1 of 2 branches missed.">        if (t.right != null) {</span>
<span class="nc" id="L121">          t = t.right;</span>
<span class="nc" id="L122">        } else {</span>
<span class="fc" id="L123">          incrementSize();</span>
<span class="fc" id="L124">          t.right = new Entry(key, t);</span>
<span class="fc" id="L125">          fixAfterInsertion(t.right);</span>
<span class="fc" id="L126">          return;</span>
        }
      }
    }
  }

  public void remove(int key) {
<span class="fc" id="L133">    Entry p = getEntry(key);</span>
<span class="fc bfc" id="L134" title="All 2 branches covered.">    if (p == null) {</span>
<span class="fc" id="L135">      return;</span>
    }

<span class="fc" id="L138">    deleteEntry(p);</span>
<span class="fc" id="L139">    return;</span>
  }

  public void print() {
    //System.out.println(&quot;*******************************************&quot;);
<span class="fc bfc" id="L144" title="All 2 branches covered.">    if (root != null) root.print(0);</span>
    //System.out.println(&quot;*******************************************&quot;);
<span class="fc" id="L146">  }</span>

  @Override
  public String toString() {
<span class="fc" id="L150">    String res = &quot;&quot;;</span>
<span class="fc bfc" id="L151" title="All 2 branches covered.">    if (root != null) res = root.toString();</span>
<span class="fc" id="L152">    return res;</span>
  }

  public String concreteString(int max_level) {
<span class="fc" id="L156">    String res = &quot;&quot;;</span>
<span class="fc bfc" id="L157" title="All 2 branches covered.">    if (root != null) res = root.concreteString(max_level, 0);</span>
<span class="fc" id="L158">    return res;</span>
  }

  private static final boolean RED = false;

<span class="fc" id="L163">  private static final boolean BLACK = true;</span>

  private static class Entry {
    int key;

<span class="pc" id="L168">    Entry left = null;</span>

<span class="pc" id="L170">    Entry right = null;</span>

    Entry parent;

<span class="pc" id="L174">    boolean color = BLACK;</span>

<span class="fc" id="L176">    Entry(int key, Entry parent) {</span>
<span class="fc" id="L177">      this.key = key;</span>
<span class="fc" id="L178">      this.parent = parent;</span>
<span class="fc" id="L179">    }</span>

<span class="nc" id="L181">    Entry(int key, Entry left, Entry right, Entry parent, boolean color) {</span>
<span class="nc" id="L182">      this.key = key;</span>
<span class="nc" id="L183">      this.left = left;</span>
<span class="nc" id="L184">      this.right = right;</span>
<span class="nc" id="L185">      this.parent = parent;</span>
<span class="nc" id="L186">      this.color = color;</span>
<span class="nc" id="L187">    }</span>

    public int getKey() {
<span class="nc" id="L190">      return key;</span>
    }

    @Override
    public String toString() {
<span class="fc bfc" id="L195" title="All 2 branches covered.">      String res = &quot;{ &quot; + (color == BLACK ? &quot;B&quot; : &quot;R&quot;) + &quot; &quot;;</span>
<span class="fc bfc" id="L196" title="All 2 branches covered.">      if (left == null) res += &quot;null&quot;;</span>
<span class="fc" id="L197">      else res += left.toString();</span>
<span class="fc" id="L198">      res += &quot; &quot;;</span>
<span class="fc bfc" id="L199" title="All 2 branches covered.">      if (right == null) res += &quot;null&quot;;</span>
<span class="fc" id="L200">      else res += right.toString();</span>
<span class="fc" id="L201">      res += &quot; }&quot;;</span>
<span class="fc" id="L202">      return res;</span>
    }

    public String concreteString(int max_level, int cur_level) {
      String res;
<span class="pc bpc" id="L207" title="1 of 2 branches missed.">      if (cur_level == max_level) {</span>
<span class="nc" id="L208">        res = &quot;{ subtree }&quot;;</span>
        //        System.out.println(&quot;Brekekek&quot;);
<span class="nc" id="L210">      } else {</span>
<span class="pc bpc" id="L211" title="1 of 2 branches missed.">        res = &quot;{ &quot; + (color == BLACK ? &quot;B&quot; : &quot;R&quot;) + key + &quot; &quot;;</span>
<span class="pc bpc" id="L212" title="1 of 2 branches missed.">        if (left == null) res += &quot;null&quot;;</span>
<span class="nc" id="L213">        else res += left.concreteString(max_level, cur_level + 1);</span>
<span class="fc" id="L214">        res += &quot; &quot;;</span>
<span class="pc bpc" id="L215" title="1 of 2 branches missed.">        if (right == null) res += &quot;null&quot;;</span>
<span class="nc" id="L216">        else res += right.concreteString(max_level, cur_level + 1);</span>
<span class="fc" id="L217">        res += &quot; }&quot;;</span>
      }

<span class="fc" id="L220">      return res;</span>
    }

    public void print(int k) {
<span class="pc bpc" id="L224" title="1 of 2 branches missed.">      for (int i = 0; i &lt; k; i++) {</span>
        //System.out.print(&quot; &quot;);
      }
      //System.out.println(key + (color == BLACK ? &quot;(B)&quot; : &quot;(R)&quot;));
<span class="pc bpc" id="L228" title="1 of 2 branches missed.">      for (int i = 0; i &lt; k; i++) {</span>
        //System.out.print(&quot; &quot;);
      }
      //System.out.println(&quot;L:&quot;);
<span class="pc bpc" id="L232" title="1 of 2 branches missed.">      if (left != null) {</span>
<span class="nc" id="L233">        left.print(k + 2);</span>
      }

<span class="pc bpc" id="L236" title="1 of 2 branches missed.">      for (int i = 0; i &lt; k; i++) {</span>
        //System.out.print(&quot; &quot;);
      }
      //System.out.println(&quot;R:&quot;);
<span class="pc bpc" id="L240" title="1 of 2 branches missed.">      if (right != null) right.print(k + 2);</span>
<span class="fc" id="L241">    }</span>
  }

  private Entry successor(Entry t) {
<span class="nc bnc" id="L245" title="All 2 branches missed.">    if (t == null) {</span>
<span class="nc" id="L246">      gen(7, t);</span>
<span class="nc" id="L247">      return null;</span>
<span class="nc bnc" id="L248" title="All 2 branches missed.">    } else if (t.right != null) {</span>
<span class="nc" id="L249">      Entry p = t.right;</span>
<span class="nc bnc" id="L250" title="All 2 branches missed.">      while (p.left != null) {</span>
<span class="nc" id="L251">        gen(8, t);</span>
<span class="nc" id="L252">        p = p.left;</span>
      }
<span class="nc" id="L254">      return p;</span>
    } else {
<span class="nc" id="L256">      Entry p = t.parent;</span>
<span class="nc" id="L257">      Entry ch = t;</span>
<span class="nc bnc" id="L258" title="All 4 branches missed.">      while (p != null &amp;&amp; ch == p.right) {</span>
<span class="nc" id="L259">        gen(9, t);</span>
<span class="nc" id="L260">        ch = p;</span>
<span class="nc" id="L261">        p = p.parent;</span>
      }
<span class="nc" id="L263">      return p;</span>
    }
  }

  private static boolean colorOf(Entry p) {
<span class="nc bnc" id="L268" title="All 2 branches missed.">    return (p == null ? BLACK : p.color);</span>
  }

  private static Entry parentOf(Entry p) {
<span class="nc bnc" id="L272" title="All 2 branches missed.">    return (p == null ? null : p.parent);</span>
  }

  private static void setColor(Entry p, boolean c) {
<span class="nc bnc" id="L276" title="All 2 branches missed.">    if (p != null) p.color = c;</span>
<span class="nc" id="L277">  }</span>

  private static Entry leftOf(Entry p) {
<span class="nc bnc" id="L280" title="All 2 branches missed.">    return (p == null) ? null : p.left;</span>
  }

  private static Entry rightOf(Entry p) {
<span class="nc bnc" id="L284" title="All 2 branches missed.">    return (p == null) ? null : p.right;</span>
  }

  /** From CLR */
  private void rotateLeft(Entry p) {
<span class="nc" id="L289">    Entry r = p.right;</span>
<span class="nc" id="L290">    p.right = r.left;</span>
<span class="nc bnc" id="L291" title="All 2 branches missed.">    if (r.left != null) {</span>
<span class="nc" id="L292">      gen(10, p);</span>
<span class="nc" id="L293">      r.left.parent = p;</span>
    }
<span class="nc" id="L295">    r.parent = p.parent;</span>
<span class="nc bnc" id="L296" title="All 2 branches missed.">    if (p.parent == null) {</span>
<span class="nc" id="L297">      gen(11, p);</span>
<span class="nc" id="L298">      root = r;</span>
<span class="nc bnc" id="L299" title="All 2 branches missed.">    } else if (p.parent.left == p) {</span>
<span class="nc" id="L300">      gen(12, p);</span>
<span class="nc" id="L301">      p.parent.left = r;</span>
<span class="nc" id="L302">    } else {</span>
<span class="nc" id="L303">      gen(13, p);</span>
<span class="nc" id="L304">      p.parent.right = r;</span>
    }
<span class="nc" id="L306">    r.left = p;</span>
<span class="nc" id="L307">    p.parent = r;</span>
<span class="nc" id="L308">  }</span>

  /** From CLR */
  private void rotateRight(Entry p) {
<span class="nc" id="L312">    Entry l = p.left;</span>
<span class="nc" id="L313">    p.left = l.right;</span>
<span class="nc bnc" id="L314" title="All 2 branches missed.">    if (l.right != null) {</span>
<span class="nc" id="L315">      gen(14, p);</span>
<span class="nc" id="L316">      l.right.parent = p;</span>
    }
<span class="nc" id="L318">    l.parent = p.parent;</span>
<span class="nc bnc" id="L319" title="All 2 branches missed.">    if (p.parent == null) {</span>
<span class="nc" id="L320">      gen(15, p);</span>
<span class="nc" id="L321">      root = l;</span>
<span class="nc bnc" id="L322" title="All 2 branches missed.">    } else if (p.parent.right == p) {</span>
<span class="nc" id="L323">      gen(16, p);</span>
<span class="nc" id="L324">      p.parent.right = l;</span>
<span class="nc" id="L325">    } else {</span>
<span class="nc" id="L326">      gen(17, p);</span>
<span class="nc" id="L327">      p.parent.left = l;</span>
    }
<span class="nc" id="L329">    l.right = p;</span>
<span class="nc" id="L330">    p.parent = l;</span>
<span class="nc" id="L331">  }</span>

  /** From CLR */
  private void fixAfterInsertion(Entry x) {
<span class="fc" id="L335">    x.color = RED;</span>

<span class="pc bpc" id="L337" title="3 of 6 branches missed.">    while (x != null &amp;&amp; x != root &amp;&amp; x.parent.color == RED) {</span>
<span class="nc bnc" id="L338" title="All 2 branches missed.">      if (parentOf(x) == leftOf(parentOf(parentOf(x)))) {</span>
<span class="nc" id="L339">        Entry y = rightOf(parentOf(parentOf(x)));</span>
<span class="nc bnc" id="L340" title="All 2 branches missed.">        if (colorOf(y) == RED) {</span>
<span class="nc" id="L341">          gen(18, x);</span>
<span class="nc" id="L342">          setColor(parentOf(x), BLACK);</span>
<span class="nc" id="L343">          setColor(y, BLACK);</span>
<span class="nc" id="L344">          setColor(parentOf(parentOf(x)), RED);</span>
<span class="nc" id="L345">          x = parentOf(parentOf(x));</span>
<span class="nc" id="L346">        } else {</span>
<span class="nc bnc" id="L347" title="All 2 branches missed.">          if (x == rightOf(parentOf(x))) {</span>
<span class="nc" id="L348">            gen(19, x);</span>
<span class="nc" id="L349">            x = parentOf(x);</span>
<span class="nc" id="L350">            rotateLeft(x);</span>
          }
<span class="nc" id="L352">          setColor(parentOf(x), BLACK);</span>
<span class="nc" id="L353">          setColor(parentOf(parentOf(x)), RED);</span>
<span class="nc bnc" id="L354" title="All 2 branches missed.">          if (parentOf(parentOf(x)) != null) {</span>
<span class="nc" id="L355">            gen(20, x);</span>
<span class="nc" id="L356">            rotateRight(parentOf(parentOf(x)));</span>
          }
        }
<span class="nc" id="L359">      } else {</span>
<span class="nc" id="L360">        Entry y = leftOf(parentOf(parentOf(x)));</span>
<span class="nc bnc" id="L361" title="All 2 branches missed.">        if (colorOf(y) == RED) {</span>
<span class="nc" id="L362">          gen(21, x);</span>
<span class="nc" id="L363">          setColor(parentOf(x), BLACK);</span>
<span class="nc" id="L364">          setColor(y, BLACK);</span>
<span class="nc" id="L365">          setColor(parentOf(parentOf(x)), RED);</span>
<span class="nc" id="L366">          x = parentOf(parentOf(x));</span>
<span class="nc" id="L367">        } else {</span>
<span class="nc bnc" id="L368" title="All 2 branches missed.">          if (x == leftOf(parentOf(x))) {</span>
<span class="nc" id="L369">            gen(22, x);</span>
<span class="nc" id="L370">            x = parentOf(x);</span>
<span class="nc" id="L371">            rotateRight(x);</span>
          }
<span class="nc" id="L373">          setColor(parentOf(x), BLACK);</span>
<span class="nc" id="L374">          setColor(parentOf(parentOf(x)), RED);</span>
<span class="nc bnc" id="L375" title="All 2 branches missed.">          if (parentOf(parentOf(x)) != null) {</span>
<span class="nc" id="L376">            gen(23, x);</span>
<span class="nc" id="L377">            rotateLeft(parentOf(parentOf(x)));</span>
          }
        }
      }
    }
<span class="fc" id="L382">    root.color = BLACK;</span>
<span class="fc" id="L383">  }</span>

  private void deleteEntry(Entry p) {
<span class="fc" id="L386">    decrementSize();</span>

    // If strictly internal, first swap position with successor.
<span class="pc bpc" id="L389" title="3 of 4 branches missed.">    if (p.left != null &amp;&amp; p.right != null) {</span>
<span class="nc" id="L390">      gen(24, p);</span>
<span class="nc" id="L391">      Entry s = successor(p);</span>
<span class="nc" id="L392">      swapPosition(s, p);</span>
    }

    // Start fixup at replacement node, if it exists.
<span class="pc bpc" id="L396" title="1 of 2 branches missed.">    Entry replacement = (p.left != null ? p.left : p.right);</span>

<span class="pc bpc" id="L398" title="1 of 2 branches missed.">    if (replacement != null) {</span>
      // Link replacement to parent
<span class="nc" id="L400">      replacement.parent = p.parent;</span>
<span class="nc bnc" id="L401" title="All 2 branches missed.">      if (p.parent == null) {</span>
<span class="nc" id="L402">        gen(25, p);</span>
<span class="nc" id="L403">        root = replacement;</span>
<span class="nc bnc" id="L404" title="All 2 branches missed.">      } else if (p == p.parent.left) {</span>
<span class="nc" id="L405">        gen(26, p);</span>
<span class="nc" id="L406">        p.parent.left = replacement;</span>
<span class="nc" id="L407">      } else {</span>
<span class="nc" id="L408">        gen(27, p);</span>
<span class="nc" id="L409">        p.parent.right = replacement;</span>
      }

      // Null out links so they are OK to use by fixAfterDeletion.
<span class="nc" id="L413">      p.left = p.right = p.parent = null;</span>

      // Fix replacement
<span class="nc bnc" id="L416" title="All 2 branches missed.">      if (p.color == BLACK) {</span>
<span class="nc" id="L417">        gen(28, p);</span>
<span class="nc" id="L418">        fixAfterDeletion(replacement);</span>
      } // MISSING else { test case .. not reachable anyway}
<span class="pc bpc" id="L420" title="1 of 2 branches missed.">    } else if (p.parent == null) { // return if we are the only node.</span>
<span class="fc" id="L421">      gen(29, p);</span>
<span class="fc" id="L422">      root = null;</span>
<span class="fc" id="L423">    } else { //  No children. Use self as phantom replacement and unlink.</span>
<span class="nc bnc" id="L424" title="All 2 branches missed.">      if (p.color == BLACK) {</span>
<span class="nc" id="L425">        gen(30, p);</span>
<span class="nc" id="L426">        fixAfterDeletion(p);</span>
      }

<span class="nc bnc" id="L429" title="All 2 branches missed.">      if (p.parent != null) {</span>
<span class="nc" id="L430">        gen(31, p);</span>
<span class="nc bnc" id="L431" title="All 2 branches missed.">        if (p == p.parent.left) {</span>
<span class="nc" id="L432">          gen(32, p);</span>
<span class="nc" id="L433">          p.parent.left = null;</span>
<span class="nc bnc" id="L434" title="All 2 branches missed.">        } else if (p == p.parent.right) {</span>
<span class="nc" id="L435">          gen(33, p);</span>
<span class="nc" id="L436">          p.parent.right = null;</span>
        } // MISSING else {test... not reachable}
<span class="nc" id="L438">        p.parent = null;</span>
      } // MISSING else ...
    }
<span class="fc" id="L441">  }</span>

  /** From CLR */
  private void fixAfterDeletion(Entry x) {
<span class="nc bnc" id="L445" title="All 4 branches missed.">    while (x != root &amp;&amp; colorOf(x) == BLACK) {</span>
<span class="nc bnc" id="L446" title="All 2 branches missed.">      if (x == leftOf(parentOf(x))) {</span>
<span class="nc" id="L447">        Entry sib = rightOf(parentOf(x));</span>

<span class="nc bnc" id="L449" title="All 2 branches missed.">        if (colorOf(sib) == RED) {</span>
          //assert false;
<span class="nc" id="L451">          gen(34, x);</span>
<span class="nc" id="L452">          setColor(sib, BLACK);</span>
<span class="nc" id="L453">          setColor(parentOf(x), RED);</span>
<span class="nc" id="L454">          rotateLeft(parentOf(x));</span>
<span class="nc" id="L455">          sib = rightOf(parentOf(x));</span>
        }

<span class="nc bnc" id="L458" title="All 4 branches missed.">        if (colorOf(leftOf(sib)) == BLACK &amp;&amp; colorOf(rightOf(sib)) == BLACK) {</span>
<span class="nc" id="L459">          gen(35, x);</span>
<span class="nc" id="L460">          setColor(sib, RED);</span>
<span class="nc" id="L461">          x = parentOf(x);</span>
<span class="nc" id="L462">        } else {</span>
<span class="nc bnc" id="L463" title="All 2 branches missed.">          if (colorOf(rightOf(sib)) == BLACK) {</span>
<span class="nc" id="L464">            gen(36, x);</span>
<span class="nc" id="L465">            setColor(leftOf(sib), BLACK);</span>
<span class="nc" id="L466">            setColor(sib, RED);</span>
<span class="nc" id="L467">            rotateRight(sib);</span>
<span class="nc" id="L468">            sib = rightOf(parentOf(x));</span>
          }
<span class="nc" id="L470">          setColor(sib, colorOf(parentOf(x)));</span>
<span class="nc" id="L471">          setColor(parentOf(x), BLACK);</span>
<span class="nc" id="L472">          setColor(rightOf(sib), BLACK);</span>
<span class="nc" id="L473">          rotateLeft(parentOf(x));</span>
<span class="nc" id="L474">          x = root;</span>
        }
<span class="nc" id="L476">      } else { // symmetric</span>
<span class="nc" id="L477">        Entry sib = leftOf(parentOf(x));</span>

<span class="nc bnc" id="L479" title="All 2 branches missed.">        if (colorOf(sib) == RED) {</span>
<span class="nc" id="L480">          gen(37, x);</span>
<span class="nc" id="L481">          setColor(sib, BLACK);</span>
<span class="nc" id="L482">          setColor(parentOf(x), RED);</span>
<span class="nc" id="L483">          rotateRight(parentOf(x));</span>
<span class="nc" id="L484">          sib = leftOf(parentOf(x));</span>
        }

<span class="nc bnc" id="L487" title="All 4 branches missed.">        if (colorOf(rightOf(sib)) == BLACK &amp;&amp; colorOf(leftOf(sib)) == BLACK) {</span>
<span class="nc" id="L488">          gen(38, x);</span>
<span class="nc" id="L489">          setColor(sib, RED);</span>
<span class="nc" id="L490">          x = parentOf(x);</span>
<span class="nc" id="L491">        } else {</span>
<span class="nc bnc" id="L492" title="All 2 branches missed.">          if (colorOf(leftOf(sib)) == BLACK) {</span>
<span class="nc" id="L493">            gen(39, x);</span>
<span class="nc" id="L494">            setColor(rightOf(sib), BLACK);</span>
<span class="nc" id="L495">            setColor(sib, RED);</span>
<span class="nc" id="L496">            rotateLeft(sib);</span>
<span class="nc" id="L497">            sib = leftOf(parentOf(x));</span>
          }
<span class="nc" id="L499">          setColor(sib, colorOf(parentOf(x)));</span>
<span class="nc" id="L500">          setColor(parentOf(x), BLACK);</span>
<span class="nc" id="L501">          setColor(leftOf(sib), BLACK);</span>
<span class="nc" id="L502">          rotateRight(parentOf(x));</span>
<span class="nc" id="L503">          x = root;</span>
        }
      }
    }

<span class="nc" id="L508">    setColor(x, BLACK);</span>
<span class="nc" id="L509">  }</span>

  /** Swap the linkages of two nodes in a tree. */
  private void swapPosition(Entry x, Entry y) {
    // Save initial values.
<span class="nc" id="L514">    Entry px = x.parent, lx = x.left, rx = x.right;</span>
<span class="nc" id="L515">    Entry py = y.parent, ly = y.left, ry = y.right;</span>
<span class="nc bnc" id="L516" title="All 4 branches missed.">    boolean xWasLeftChild = px != null &amp;&amp; x == px.left;</span>
<span class="nc bnc" id="L517" title="All 4 branches missed.">    boolean yWasLeftChild = py != null &amp;&amp; y == py.left;</span>

    //    System.out.println(&quot;Swap: &quot;+x.key+&quot; &quot;+y.key);
    // Swap, handling special cases of one being the other's parent.
<span class="nc bnc" id="L521" title="All 2 branches missed.">    if (x == py) { // x was y's parent</span>
<span class="nc" id="L522">      x.parent = y;</span>
<span class="nc bnc" id="L523" title="All 2 branches missed.">      if (yWasLeftChild) {</span>
<span class="nc" id="L524">        gen(40, x);</span>
<span class="nc" id="L525">        y.left = x;</span>
<span class="nc" id="L526">        y.right = rx;</span>
<span class="nc" id="L527">      } else {</span>
<span class="nc" id="L528">        gen(41, x);</span>
<span class="nc" id="L529">        y.right = x;</span>
<span class="nc" id="L530">        y.left = lx;</span>
      }
<span class="nc" id="L532">    } else {</span>
<span class="nc" id="L533">      x.parent = py;</span>
<span class="nc bnc" id="L534" title="All 2 branches missed.">      if (py != null) {</span>
<span class="nc bnc" id="L535" title="All 2 branches missed.">        if (yWasLeftChild) {</span>
<span class="nc" id="L536">          gen(42, x);</span>
<span class="nc" id="L537">          py.left = x;</span>
<span class="nc" id="L538">        } else {</span>
<span class="nc" id="L539">          gen(43, x);</span>
<span class="nc" id="L540">          py.right = x;</span>
        }
      }
<span class="nc" id="L543">      y.left = lx;</span>
<span class="nc" id="L544">      y.right = rx;</span>
    }

<span class="nc bnc" id="L547" title="All 2 branches missed.">    if (y == px) { // y was x's parent</span>
<span class="nc" id="L548">      y.parent = x;</span>
<span class="nc bnc" id="L549" title="All 2 branches missed.">      if (xWasLeftChild) {</span>
<span class="nc" id="L550">        gen(44, x);</span>
<span class="nc" id="L551">        x.left = y;</span>
<span class="nc" id="L552">        x.right = ry;</span>
<span class="nc" id="L553">      } else {</span>
<span class="nc" id="L554">        gen(45, x);</span>
<span class="nc" id="L555">        x.right = y;</span>
<span class="nc" id="L556">        x.left = ly;</span>
      }
<span class="nc" id="L558">    } else {</span>
<span class="nc" id="L559">      y.parent = px;</span>
<span class="nc bnc" id="L560" title="All 2 branches missed.">      if (px != null) {</span>
<span class="nc bnc" id="L561" title="All 2 branches missed.">        if (xWasLeftChild) {</span>
<span class="nc" id="L562">          gen(46, x);</span>
<span class="nc" id="L563">          px.left = y;</span>
<span class="nc" id="L564">        } else {</span>
<span class="nc" id="L565">          gen(47, x);</span>
<span class="nc" id="L566">          px.right = y;</span>
        }
      }
<span class="nc" id="L569">      x.left = ly;</span>
<span class="nc" id="L570">      x.right = ry;</span>
    }

    // Fix children's parent pointers
<span class="nc bnc" id="L574" title="All 2 branches missed.">    if (x.left != null) {</span>
<span class="nc" id="L575">      gen(48, x);</span>
<span class="nc" id="L576">      x.left.parent = x;</span>
    }
<span class="nc bnc" id="L578" title="All 2 branches missed.">    if (x.right != null) {</span>
<span class="nc" id="L579">      gen(49, x);</span>
<span class="nc" id="L580">      x.right.parent = x;</span>
    }
<span class="nc bnc" id="L582" title="All 2 branches missed.">    if (y.left != null) {</span>
<span class="nc" id="L583">      gen(50, x);</span>
<span class="nc" id="L584">      y.left.parent = y;</span>
    }
<span class="nc bnc" id="L586" title="All 2 branches missed.">    if (y.right != null) {</span>
<span class="nc" id="L587">      gen(51, x);</span>
<span class="nc" id="L588">      y.right.parent = y;</span>
    }

    // Swap colors
<span class="nc" id="L592">    boolean c = x.color;</span>
<span class="nc" id="L593">    x.color = y.color;</span>
<span class="nc" id="L594">    y.color = c;</span>

    // Check if root changed
<span class="nc bnc" id="L597" title="All 2 branches missed.">    if (root == x) {</span>
<span class="nc" id="L598">      gen(52, x);</span>
<span class="nc" id="L599">      root = y;</span>
<span class="nc bnc" id="L600" title="All 2 branches missed.">    } else if (root == y) {</span>
<span class="nc" id="L601">      gen(53, x);</span>
<span class="nc" id="L602">      root = x;</span>
    }
<span class="nc" id="L604">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>